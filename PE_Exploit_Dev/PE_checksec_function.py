#!/usr/bin/env python

import pefile

def checksec(pe):
 lflag=list()
 if pe.OPTIONAL_HEADER.IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE:
  print "ASLR: True"
 else:
  print "ASLR: False"
 if pe.OPTIONAL_HEADER.IMAGE_DLL_CHARACTERISTICS_NX_COMPAT:
  print "DEP: True"
 else:
  print "DEP: False"
 if pe.DIRECTORY_ENTRY_LOAD_CONFIG.struct.SecurityCookie==0:
  print "Stack cookie: False"
 else:
  print "Stack cookie: True"
 for i in pe.OPTIONAL_HEADER.DATA_DIRECTORY:
  lflag.append(i)
 if "IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG" in lflag:
   print "SAFESEH: True"
 else:
  print "SAFESEH: False"
 if pe.OPTIONAL_HEADER.IMAGE_DLL_CHARACTERISTICS_NO_SEH:
  print "NOSEH: True"
 else:
  print "NOSEH: False"
  
  # Usage exemple:
  pe=pefile.PE('drive:/path/binaryName')
  checksec(pe)
